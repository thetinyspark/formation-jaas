#!/bin/bash
# Hook post-receive : d√©ploiement automatique dans ~/git-hooks-demo/production

# Chemin absolu vers ton dossier de production
WORK_TREE=C:/Users/BlackBeard/Desktop/test/production
GIT_DIR=C:/Users/BlackBeard/Desktop/test/server.git

# Lecture des r√©f√©rences re√ßues
while read oldrev newrev ref
do
  # On ne d√©ploie que si la branche "master" est mise √† jour
  if [[ $ref == refs/heads/master ]]; then
    echo "üöÄ D√©ploiement sur la branche main..."

    # Par exemple ici, je peux conditionner le d√©ploiement √† des tests 
    # ICI DECLENCHER JUNIT OU AUTRE OUTIL DE TESTS
    # si les tests passent alors je d√©ploie mes sources de ma branche master vers le working tree
    git --work-tree=$WORK_TREE --git-dir=$GIT_DIR checkout -f master

    # Je lance l'obfuscation des sources dans le working tree
    # ICI DECLENCHER L'OBFUSCATION DES SOURCES ( avec proguard ou autre outil )
    # Je lance le build de production dans le working tree
    # ICI DECLENCHER LE BUILD DE PRODUCTION ( avec maven, gradle ou autre outil )
    
    echo "‚úÖ D√©ploiement termin√© dans $WORK_TREE"
  else
    echo "‚ÑπÔ∏è Push re√ßu sur $ref ‚Äî pas de d√©ploiement"
  fi
done